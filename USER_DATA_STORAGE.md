# üìä –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Strava

## üîç –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

–ü—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Strava OAuth —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```json
{
  "athlete_id": 123456789,
  "username": "john_doe",
  "firstname": "John",
  "lastname": "Doe",
  "email": "john@example.com",
  "city": "San Francisco",
  "country": "United States",
  "profile_picture": "https://...",
  "created_at": "2015-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z",
  "connected_at": "2024-12-20T12:00:00",
  "access_token_hash": "a1b2c3d4e5f6..."
}
```

### ‚ö†Ô∏è –í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± Email

**Strava API –æ–±—ã—á–Ω–æ –ù–ï –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. Email –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑—Ä–µ—à–∏–ª –¥–æ—Å—Ç—É–ø –∫ email –≤ scope
2. –≠—Ç–æ –≤–∞—à —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç Strava

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –ø–æ–ª–µ `email` –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å `"not_provided"`.

---

## üìÅ –ì–¥–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ

–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `data/` –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
data/
‚îî‚îÄ‚îÄ athlete_123456789.json
```

–ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º `athlete_id`.

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ:

1. **–¢–æ–∫–µ–Ω—ã**: –¢–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞ **–ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ**. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ö–µ—à.
2. **–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–∞–Ω–Ω—ã—Ö**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `.gitignore` - –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ git
3. **–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å**: –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### ‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è production:

1. **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**: –í production —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
2. **–ë–î**: –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ JSON —Ñ–∞–π–ª–æ–≤
3. **GDPR**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–æ–±–ª—é–¥–∞–µ—Ç–µ GDPR –∏ –ø–æ–ª—É—á–∞–µ—Ç–µ —Å–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **Backup**: –†–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –¥–∞–Ω–Ω—ã—Ö

---

## üõ°Ô∏è GDPR –∏ Privacy

### –û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –ø–æ GDPR:

1. **–°–æ–≥–ª–∞—Å–∏–µ**: –£–≤–µ–¥–æ–º–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ
2. **–ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ**: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ø–æ—Å–æ–± —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
3. **–ü—Ä–∞–≤–æ –Ω–∞ –¥–æ—Å—Ç—É–ø**: –ü–æ–∑–≤–æ–ª—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
4. **–ü—Ä–∞–≤–æ –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–∞–π—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

### Privacy Policy

–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à—É Privacy Policy:
- –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è
- –ó–∞—á–µ–º –æ–Ω–∏ –Ω—É–∂–Ω—ã
- –ö–∞–∫ –¥–æ–ª–≥–æ —Ö—Ä–∞–Ω—è—Ç—Å—è
- –ö—Ç–æ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø
- –ö–∞–∫ —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

---

## üìù –ö–∞–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
ls data/

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
cat data/athlete_123456789.json

# –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥
cat data/athlete_123456789.json | python -m json.tool
```

### –ß–µ—Ä–µ–∑ Python:

```python
import json
import os

# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
for filename in os.listdir('data/'):
    with open(f'data/{filename}', 'r') as f:
        user_data = json.load(f)
        print(f"{user_data['firstname']} {user_data['lastname']}")
        print(f"ID: {user_data['athlete_id']}")
        print(f"Email: {user_data.get('email', 'Not provided')}")
        print(f"Connected: {user_data['connected_at']}")
        print("---")
```

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–æ–µ –ø–æ–ª–µ `connected_at` —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

---

## üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```bash
rm data/athlete_123456789.json
```

### –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ:

```bash
rm -rf data/
```

### API –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–±—É–¥—É—â–µ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ):

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```python
DELETE /api/user/delete?athlete_id=123456789
```

---

## üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ü—Ä–æ—Å—Ç–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

```python
import json
import os
from datetime import datetime

users = []
for filename in os.listdir('data/'):
    if filename.endswith('.json'):
        with open(f'data/{filename}', 'r') as f:
            users.append(json.load(f))

print(f"Total users: {len(users)}")
print(f"Users from last 7 days: {sum(1 for u in users if is_recent(u['connected_at']))}")
```

---

## üöÄ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (production)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:

```sql
CREATE TABLE athletes (
    athlete_id BIGINT PRIMARY KEY,
    username VARCHAR(255),
    firstname VARCHAR(255),
    lastname VARCHAR(255),
    email VARCHAR(255),
    city VARCHAR(255),
    country VARCHAR(255),
    profile_picture TEXT,
    created_at DATETIME,
    updated_at DATETIME,
    connected_at DATETIME,
    access_token_hash VARCHAR(64),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:

```python
import json
import os
import mysql.connector

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
db = mysql.connector.connect(...)
cursor = db.cursor()

# –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ JSON –≤ –ë–î
for filename in os.listdir('data/'):
    with open(f'data/{filename}', 'r') as f:
        user_data = json.load(f)
        
        # –í—Å—Ç–∞–≤–∫–∞ –≤ –ë–î
        sql = "INSERT INTO athletes (...) VALUES (...)"
        cursor.execute(sql, tuple(user_data.values()))

db.commit()
```

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**: `python3 server.py`
2. **–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ Strava**
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ**: `ls data/`
4. **–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ**: `cat data/athlete_*.json`

–ì–æ—Ç–æ–≤–æ! üéâ

---

**–í–Ω–∏–º–∞–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–æ–±–ª—é–¥–∞–µ—Ç–µ GDPR –∏ –ø–æ–ª—É—á–∞–µ—Ç–µ —Å–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Ö –¥–∞–Ω–Ω—ã—Ö.

