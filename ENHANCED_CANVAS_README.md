# Enhanced Canvas System - nextPoly Inspired

## üéØ –û–±–∑–æ—Ä

–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ canvas –≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ nextPoly –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Å –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π.

## üöÄ –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### ‚ú® **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã**
- –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ overlay –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞
- –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π —Ñ–ª–∞–≥)
- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –∏ –∞–Ω–∏–º–∞—Ü–∏–∏

### üèóÔ∏è **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- –õ–µ–≥–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### üì± **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å –≥–∏–±–∫–∏–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π —Å—Ç–æ—Ä–æ–Ω
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ DPR

### üé® **–¢–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞**
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–∞
- –ü–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
‚îú‚îÄ‚îÄ canvas-system-enhanced.js    # –û—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ canvas
‚îú‚îÄ‚îÄ app-enhanced.js             # –û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ index.html                  # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π HTML
‚îî‚îÄ‚îÄ README.md                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```javascript
// –°–æ–∑–¥–∞–Ω–∏–µ canvas —Å–∏—Å—Ç–µ–º—ã
const canvasSystem = new EnhancedCanvasSystem(canvas, {
    width: 400,
    height: 1400,
    aspectRatio: '9/16',
    maxDPR: 2,
    padding: 0.08,
    fontFamily: 'Inter, sans-serif',
    fontFamilyBold: 'Inter, sans-serif',
    primaryColor: '#FFFFFF',
    secondaryColor: '#888888',
    overlayOpacity: 0.4
});
```

### –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

```javascript
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–æ–Ω–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
canvasSystem.setBackgroundImage('path/to/image.jpg');

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞
canvasSystem.setPolylineData(encodedPolyline);

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞
canvasSystem.setTitle('Workout Title', 'Subtitle');

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–µ—Ç—Ä–∏–∫
canvasSystem.setMetrics([
    { label: 'DISTANCE', value: '15.2 km' },
    { label: 'ELEVATION', value: '500 m' },
    { label: 'TIME', value: '1h 30m' }
]);

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–∞
canvasSystem.setLogo('path/to/logo.svg');

// –†–µ–Ω–¥–µ—Ä–∏–Ω–≥
canvasSystem.render();
```

### –≠–∫—Å–ø–æ—Ä—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

```javascript
// –≠–∫—Å–ø–æ—Ä—Ç –∫–∞–∫ DataURL
const dataURL = canvasSystem.exportAsImage('image/png', 1.0);

// –≠–∫—Å–ø–æ—Ä—Ç –∫–∞–∫ Blob –¥–ª—è sharing
const blob = await canvasSystem.exportAsBlob('image/png', 1.0);
```

## üé® –°–∏—Å—Ç–µ–º–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

### –°–ª–æ–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ (–≤ –ø–æ—Ä—è–¥–∫–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è)

1. **–§–æ–Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ** - –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–Ω —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º
2. **Overlay —ç—Ñ—Ñ–µ–∫—Ç** - –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è –ø–æ–¥–ª–æ–∂–∫–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞
3. **–ú–∞—Ä—à—Ä—É—Ç** - –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –ª–∏–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞
4. **–ö–æ–Ω—Ç–µ–Ω—Ç** - –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏
5. **–õ–æ–≥–æ—Ç–∏–ø** - –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –ª–æ–≥–æ—Ç–∏–ø

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –º–∞—Å—à—Ç–∞–±–∞
const scaleX = containerWidth / internalWidth;
const scaleY = containerHeight / internalHeight;
const scale = Math.min(scaleX, scaleY);

// –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
const offsetX = (containerWidth - (internalWidth * scale)) / 2;
const offsetY = (containerHeight - (internalHeight * scale)) / 2;
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
3. **–°–æ—Å—Ç–æ—è–Ω–∏–µ** - –ß–µ—Ç–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
4. **API** - –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–µ–∫—É—â–∏–º API
- ‚úÖ –ü–ª–∞–≤–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑ breaking changes
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- üß© **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- üîß **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- üìö **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** - –ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- üöÄ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üé® **–ö–∞—á–µ—Å—Ç–≤–æ** - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
- üì± **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - –ò–¥–µ–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- ‚ö° **–°–∫–æ—Ä–æ—Å—Ç—å** - –ë—ã—Å—Ç—Ä—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏ –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å
- üéØ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** - –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –æ–ø—ã—Ç

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–π
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤
- [ ] –°–∏—Å—Ç–µ–º–∞ —Ç–µ–º
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π –±—Ä–∞—É–∑–µ—Ä–∞

---

*–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ–º –æ—Ç –ø—Ä–æ–µ–∫—Ç–∞ nextPoly –∏ —Å–ª–µ–¥—É–µ—Ç –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.*
